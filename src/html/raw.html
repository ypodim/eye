<!doctype html>
<head>
<meta charset="UTF-8" />
<script src="/static/jquery.min.js"></script>
<script>
var ws = new WebSocket("ws://"+location.host+"/ws");
ws.onopen = function() {
   // ws.send("Hello, world");
};
ws.onmessage = function (evt) {
   var data = JSON.parse(evt.data);
   id = "#"+data.sensor_name;
   
   var embed = $("<embed />").addClass("chart").attr("type", "image/svg+xml");
   embed.attr("src", "/charts/"+data.sensor_name);

   var sensor_name = $("<div></div>").addClass("sensor_name").html(data.sensor_name);
   var sensor_value = $("<div></div>").addClass("sensor_value").html(data.sensor_value);

   var store_size = $("<div></div>").addClass("store_size").html("store_size:"+data.sensor_stats.store_size);
   var inst_sum = $("<div></div>").addClass("store_size").html("inst_sum:"+data.sensor_stats.inst_sum);
   var inst_total = $("<div></div>").addClass("inst_total").html("inst_total:"+data.sensor_stats.inst_total);

   $(id).html("").append(sensor_name, sensor_value, store_size, inst_sum, inst_total, embed);
};

$(document).ready(function() {  
   // console.log("started");
}); 

</script>

<style>
.chart { width: 500px; height: 400px; }
.sensor { margin: 10px; flow:horizontal; display:inline-block; }
</style></head>
<body>
<div id="chart">
   <div class="sensor" id="internaltemp"></div>
   <div class="sensor" id="soil_moisture"></div>
   <div class="sensor" id="mic"></div>
   <div class="sensor" id="light"></div>
   <div class="sensor" id="temperature"></div>
   <div class="sensor" id="testSensor"></div>
</div>
</body>

</html>